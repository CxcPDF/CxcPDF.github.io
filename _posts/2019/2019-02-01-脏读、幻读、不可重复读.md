---
layout: post
title: 脏读、幻读、不可重复读
categories: [数据库]
description: 脏读、幻读、不可重复读
keywords: 数据库

---



### 丢失更新

>两个事务同时更新一行数据，最后一个事务的更新会覆盖掉第一个事务的更新，从而导致第一个事务更新的数据丢失，这是由于没有加锁造成的


### 脏读

>脏读就是指当一个事务正在访问数据，并且对数据进行了修改，而这种修改还没有提交到数据库中，这时，另外一个事务也访问这个数据，然后使用了这个数据。

e.g.        
1. Mary的原工资为1000, 财务人员将Mary的工资改为了8000(但未提交事务) 
2. Mary读取自己的工资 ,发现自己的工资变为了8000，欢天喜地！
3. 而财务发现操作有误，回滚了事务,Mary的工资又变为了1000
    像这样,Mary记取的工资数8000是一个脏数据。
### 不可重复读
>是指在一个事务内，多次读同一数据。在这个事务还没有结束时，另外一个事务也访问该同一数据。那么，在第一个事务中的两次读数据之间，由于第二个事务的修改，那么第一个事务两次读到的的数据可能是不一样的。这样在一个事务内两次读到的数据是不一样的，因此称为是不可重复读。

    e.g.
    1.在事务1中，Mary 读取了自己的工资为1000,操作并没有完成
    2.在事务2中，这时财务人员修改了Mary的工资为2000,并提交了事务.
    3.在事务1中，Mary 再次读取自己的工资时，工资变为了2000 解决办法：如果只有在修改事务完全提交之后才可以读取数据，则可以避免该问题。
``
解决办法：如果只有在修改事务完全提交之后才可以读取数据，则可以避免该问题。``
### 幻读
>是指当事务不是独立执行时发生的一种现象，例如第一个事务对一个表中的数据进行了修改，这种修改涉及到表中的全部数据行。同时，第二个事务也修改这个表中的数据，这种修改是向表中插入一行新数据。那么，以后就会发生操作第一个事务的用户发现表中还有没有修改的数据行，就好象发生了幻觉一样。

e.g. 
目前工资为1000的员工有10人。  
1. 事务1,读取所有工资为1000的员工。  
2. 这时事务2向employee表插入了一条员工记录，工资也为1000   
3. 事务1再次读取所有工资为1000的员工 共读取到了11条记录
    ``
    解决办法：如果在操作事务完成数据处理之前，任何其他事务都不可以添加新数据，则可避免该问题``



在一个程序中，依据事务的隔离级别将会有三种情况发生。　　　　
    ◆脏读：一个事务会读进还没有被另一个事务提交的数据，所以你会看到一些最后被另一个事务回滚掉的数据。　　
    ◆不可重复读：一个事务读进一条记录，另一个事务更改了这条记录并提交完毕，这时候第一个事务再次读这条记录时，它已经改变了。　　
    ◆ 幻影读：一个事务用Where子句来检索一个表的数据，另一个事务插入一条新的记录，并且符合Where条件，这样，第一个事务用同一个where条件来检索数据后，就会多出一条记录。




欢迎关注我的微信公众号，接收最新动态。

<div align="center"><img width="192px" height="192px" src="https://i.postimg.cc/pdykktnS/weichat.jpg"/></div>